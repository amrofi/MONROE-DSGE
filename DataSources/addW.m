%after importing data of each contry, we need nominal gdp, gdp deflator, nominal exchange rate, population
%use this script to calculate world data and country/world data
%then save data
load data_ready_global.mat
%mean(,'omitnan')
%%
yW=(JSTy1./JSTxrusd1+JSTy2./JSTxrusd2);
yWqlag=(JSTy1(1:end-1)./JSTpy1(1:end-1).*JSTpy1(2:end)./JSTxrusd1(2:end)...
       +JSTy2(1:end-1)./JSTpy2(1:end-1).*JSTpy2(2:end)./JSTxrusd2(2:end));
yWplag=(JSTy1(2:end)./JSTpy1(2:end).*JSTpy1(1:end-1)./JSTxrusd1(1:end-1)...
       +JSTy2(2:end)./JSTpy2(2:end).*JSTpy2(1:end-1)./JSTxrusd2(1:end-1));
popW=MPDpopGLO;

popshare1=MPDpop1./popW;
popshare2=MPDpop2./popW;
gpopW=[nan;log(popW(2:end)./popW(1:end-1))];

yshare1=JSTy1./JSTxrusd1./yW;
gryW=[nan;log((yW(2:end)./yWqlag.*yWplag./yW(1:end-1)).^(0.5))];

save('data_2country_Wdata','yshare1','popshare1','popshare2','gpopW','gryW')
%%
yW=(JSTy1./JSTxrusd1+JSTy2./JSTxrusd2+MILLy3./MILLxrusd3+JSTy4./JSTxrusd4);
yWqlag=(JSTy1(1:end-1)./JSTpy1(1:end-1).*JSTpy1(2:end)./JSTxrusd1(2:end)...
       +JSTy2(1:end-1)./JSTpy2(1:end-1).*JSTpy2(2:end)./JSTxrusd2(2:end)...
       +MILLy3(1:end-1)./MILLpy3(1:end-1).*MILLpy3(2:end)./MILLxrusd3(2:end)...
       +JSTy4(1:end-1)./JSTpy4(1:end-1).*JSTpy4(2:end)./JSTxrusd4(2:end));
yWplag=(JSTy1(2:end)./JSTpy1(2:end).*JSTpy1(1:end-1)./JSTxrusd1(1:end-1)...
       +JSTy2(2:end)./JSTpy2(2:end).*JSTpy2(1:end-1)./JSTxrusd2(1:end-1)...
       +MILLy3(2:end)./MILLpy3(2:end).*MILLpy3(1:end-1)./MILLxrusd3(1:end-1)...
       +JSTy4(2:end)./JSTpy4(2:end).*JSTpy4(1:end-1)./JSTxrusd4(1:end-1));
popW=MPDpopGLO;

popshare1=MPDpop1./popW;
popshare2=MPDpop2./popW;
popshare3=MILLpop3./popW;
popshare4=MPDpop4./popW;
gpopW=[nan;log(popW(2:end)./popW(1:end-1))];

yshare1=JSTy1./JSTxrusd1./yW;
yshare2=JSTy2./JSTxrusd2./yW;
yshare3=MILLy3./MILLxrusd3./yW;
gryW=[nan;log((yW(2:end)./yWqlag.*yWplag./yW(1:end-1)).^(0.5))];

save('data_4country_Wdata','yshare1','yshare2','yshare3','popshare1','popshare2','popshare3','popshare4','gpopW','gryW')
%%
yW=(JSTy1./JSTxrusd1+JSTy2./JSTxrusd2+MILLy3./MILLxrusd3+JSTy4./JSTxrusd4+...
    JSTy51./JSTxrusd51+JSTy52./JSTxrusd52+JSTy53./JSTxrusd53+JSTy54./JSTxrusd54+JSTy55./JSTxrusd55+JSTy56./JSTxrusd56+JSTy57./JSTxrusd57+JSTy58./JSTxrusd58+...
    JSTy61./JSTxrusd61+JSTy62./JSTxrusd62+JSTy63./JSTxrusd63+JSTy64./JSTxrusd64+JSTy65./JSTxrusd65);
yWqlag=(JSTy1(1:end-1)./JSTpy1(1:end-1).*JSTpy1(2:end)./JSTxrusd1(2:end)...
       +JSTy2(1:end-1)./JSTpy2(1:end-1).*JSTpy2(2:end)./JSTxrusd2(2:end)...
       +MILLy3(1:end-1)./MILLpy3(1:end-1).*MILLpy3(2:end)./MILLxrusd3(2:end)...
       +JSTy4(1:end-1)./JSTpy4(1:end-1).*JSTpy4(2:end)./JSTxrusd4(2:end)...
       +JSTy51(1:end-1)./JSTpy51(1:end-1).*JSTpy51(2:end)./JSTxrusd51(2:end)...
       +JSTy52(1:end-1)./JSTpy52(1:end-1).*JSTpy52(2:end)./JSTxrusd52(2:end)...
       +JSTy53(1:end-1)./JSTpy53(1:end-1).*JSTpy53(2:end)./JSTxrusd53(2:end)...
       +JSTy54(1:end-1)./JSTpy54(1:end-1).*JSTpy54(2:end)./JSTxrusd54(2:end)...
       +JSTy55(1:end-1)./JSTpy55(1:end-1).*JSTpy55(2:end)./JSTxrusd55(2:end)...
       +JSTy56(1:end-1)./JSTpy56(1:end-1).*JSTpy56(2:end)./JSTxrusd56(2:end)...
       +JSTy57(1:end-1)./JSTpy57(1:end-1).*JSTpy57(2:end)./JSTxrusd57(2:end)...
       +JSTy58(1:end-1)./JSTpy58(1:end-1).*JSTpy58(2:end)./JSTxrusd58(2:end)...
       +JSTy61(1:end-1)./JSTpy61(1:end-1).*JSTpy61(2:end)./JSTxrusd61(2:end)...
       +JSTy62(1:end-1)./JSTpy62(1:end-1).*JSTpy62(2:end)./JSTxrusd62(2:end)...
       +JSTy63(1:end-1)./JSTpy63(1:end-1).*JSTpy63(2:end)./JSTxrusd63(2:end)...
       +JSTy64(1:end-1)./JSTpy64(1:end-1).*JSTpy64(2:end)./JSTxrusd64(2:end)...
       +JSTy65(1:end-1)./JSTpy65(1:end-1).*JSTpy65(2:end)./JSTxrusd65(2:end)...
	   );
yWplag=(JSTy1(2:end)./JSTpy1(2:end).*JSTpy1(1:end-1)./JSTxrusd1(1:end-1)...
       +JSTy2(2:end)./JSTpy2(2:end).*JSTpy2(1:end-1)./JSTxrusd2(1:end-1)...
       +MILLy3(2:end)./MILLpy3(2:end).*MILLpy3(1:end-1)./MILLxrusd3(1:end-1)...
       +JSTy4(2:end)./JSTpy4(2:end).*JSTpy4(1:end-1)./JSTxrusd4(1:end-1)...
	   +JSTy51(2:end)./JSTpy51(2:end).*JSTpy51(1:end-1)./JSTxrusd51(1:end-1)...
       +JSTy52(2:end)./JSTpy52(2:end).*JSTpy52(1:end-1)./JSTxrusd52(1:end-1)...
       +JSTy53(2:end)./JSTpy53(2:end).*JSTpy53(1:end-1)./JSTxrusd53(1:end-1)...
       +JSTy54(2:end)./JSTpy54(2:end).*JSTpy54(1:end-1)./JSTxrusd54(1:end-1)...
       +JSTy55(2:end)./JSTpy55(2:end).*JSTpy55(1:end-1)./JSTxrusd55(1:end-1)...
       +JSTy56(2:end)./JSTpy56(2:end).*JSTpy56(1:end-1)./JSTxrusd56(1:end-1)...
       +JSTy57(2:end)./JSTpy57(2:end).*JSTpy57(1:end-1)./JSTxrusd57(1:end-1)...
       +JSTy58(2:end)./JSTpy58(2:end).*JSTpy58(1:end-1)./JSTxrusd58(1:end-1)...
       +JSTy61(2:end)./JSTpy61(2:end).*JSTpy61(1:end-1)./JSTxrusd61(1:end-1)...
       +JSTy62(2:end)./JSTpy62(2:end).*JSTpy62(1:end-1)./JSTxrusd62(1:end-1)...
       +JSTy63(2:end)./JSTpy63(2:end).*JSTpy63(1:end-1)./JSTxrusd63(1:end-1)...
       +JSTy64(2:end)./JSTpy64(2:end).*JSTpy64(1:end-1)./JSTxrusd64(1:end-1)...
       +JSTy65(2:end)./JSTpy65(2:end).*JSTpy65(1:end-1)./JSTxrusd65(1:end-1)...
	   );
popW=MPDpopGLO;

popshare1=MPDpop1./popW;
popshare2=MPDpop2./popW;
popshare3=MILLpop3./popW;
popshare4=MPDpop4./popW;
popshare5=(MPDpop51+MPDpop52+MPDpop53+MPDpop54+MPDpop55+MPDpop56+MPDpop57+MPDpop58)./popW;
popshare6=(MPDpop61+MPDpop62+MPDpop63+MPDpop64+MPDpop65)./popW;
gpopW=[nan;log(popW(2:end)./popW(1:end-1))];

yshare1=JSTy1./JSTxrusd1./yW;
yshare2=JSTy2./JSTxrusd2./yW;
yshare3=MILLy3./MILLxrusd3./yW;
yshare4=JSTy4./JSTxrusd4./yW;
yshare5=(JSTy51./JSTxrusd51+JSTy52./JSTxrusd52+JSTy53./JSTxrusd53+JSTy54./JSTxrusd54+JSTy55./JSTxrusd55+JSTy56./JSTxrusd56+JSTy57./JSTxrusd57+JSTy58./JSTxrusd58)./yW;
gryW=[nan;log((yW(2:end)./yWqlag.*yWplag./yW(1:end-1)).^(0.5))];

save('data_6country_Wdata','yshare1','yshare2','yshare3','yshare4','yshare5','popshare1','popshare2','popshare3','popshare4','popshare5','popshare6','gpopW','gryW')
